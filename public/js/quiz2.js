var worshipQuestions={tableName:"worshipquestions"},messageQuestions={tableName:"messagequestions"},scriptures={tableName:"scripturematerials"},allProcessedQuestions=[],questionOrScripturesActedOn=0,questionSet="Worship",CORRECT_ANSWER=5,INCORRECT_ANSWER=1,NO_ANSWER=0,earnedPoints=0,currentQuizStatus={cTab:"Worship",wQAnswered:"0",mQAnswered:"0",sTyped:"0",tPoints:"0",eAForToday:"0",totalAggregate:"",email:"",age:""},messageTitle="The Kingdom Power of Self Government",messageType="Online Quiz",messageSource="Myles Munroe";jQuery(document).ready(function(){function e(e){switch(e){case"Worship":t(e,worshipQuestions);break;case"Message":t(e,messageQuestions);break;case"Scripture":t(e,scriptures)}}function t(e,t){jQuery.ajax({type:"POST",url:"../config/getQuizQuestionsFromDB.php",data:t,success:function(t){r(t,e),u(e)},error:function(e,t,r){alert("Error: "+t+" from loadQuestionsFromDb")},dataType:"json"})}function r(e,t){allProcessedQuestions=[];for(var r=0;r<e.length;r++)if("Scripture"===t){var s={reference:"",words:""};s.reference=e[r].reference,s.words=e[r].words,allProcessedQuestions.push(s)}else{var a={question:"",options:[],answers:[]};a.question=e[r].question,a.options=e[r].options.split(","),a.answers=e[r].answers,allProcessedQuestions.push(a)}jQuery(".totalQuestionNumber").text(allProcessedQuestions.length),jQuery(".totalQuestionsAnswered").text(questionOrScripturesActedOn),jQuery(".totalPointsGained").text(currentQuizStatus.tPoints)}function s(e,t){t>allProcessedQuestions.length-1?"scripture"===e?(jQuery("#scriptureInfo").html(""),jQuery("#scriptureReferenceLabel").html(""),jQuery("#scriptureReferenceInput").val(""),jQuery("#scriptureTextArea").val(""),jQuery("#scriptureLabel").text("You have completed the scriptures for the week!!!")):("worship"===e?jQuery("#worshipInfo").html(""):jQuery("#messageInfo").html(""),jQuery("#"+e+"QuestionLabel").text("You have completed the "+questionSet+" questions for the week!!!"),jQuery("#"+e+"OptionsSelectList").html(""),jQuery("#"+e+"OptionsSelectList").append(jQuery("<option />",{text:"Disabled..."}))):"scripture"===e?(jQuery("#scriptureLabel").text(allProcessedQuestions[t].words),jQuery("#scriptureReferenceLabel").text(allProcessedQuestions[t].reference),jQuery("#scriptureReferenceInput").val(""),jQuery("#scriptureTextArea").val("")):("worship"===e?jQuery("#worshipInfo").html("You CANNOT RETAKE A QUESTION. Give this question your best attempt."):jQuery("#messageInfo").html("You CANNOT RETAKE A QUESTION. Give this question your best attempt."),jQuery("#"+e+"QuestionLabel").html(allProcessedQuestions[t].question),jQuery("#"+e+"OptionsSelectList").html(""),jQuery("#"+e+"OptionsSelectList").append(jQuery("<option />",{text:"Select the most appropriate answer..."})),jQuery.each(allProcessedQuestions[t].options,function(t,r){jQuery("#"+e+"OptionsSelectList").append(jQuery("<option />",{text:r}))}))}function a(e,t){switch(t){case"worshipNextBtn":var r=jQuery("#worshipOptionsSelectList").val(),s=allProcessedQuestions[e].answers;earnedPoints=r.toLowerCase()===s.toLowerCase()?CORRECT_ANSWER:INCORRECT_ANSWER;break;case"messageNextBtn":var r=jQuery("#messageOptionsSelectList").val(),s=allProcessedQuestions[e].answers;earnedPoints=r.toLowerCase()===s.toLowerCase()?CORRECT_ANSWER:INCORRECT_ANSWER;break;case"scriptureNextBtn":var a=jQuery("#scriptureTextArea").val(),u=jQuery("#scriptureReferenceInput").val(),i=allProcessedQuestions[e].words,o=allProcessedQuestions[e].reference;earnedPoints=a.toLowerCase()===i.toLowerCase()?CORRECT_ANSWER:""===jQuery.trim(a.toLowerCase())?NO_ANSWER:INCORRECT_ANSWER,earnedPoints=u.toLowerCase()===o.toLowerCase()?CORRECT_ANSWER:""===jQuery.trim(u.toLowerCase())?NO_ANSWER:INCORRECT_ANSWER}currentQuizStatus.tPoints=(parseInt(currentQuizStatus.tPoints)+earnedPoints).toString()}function u(e){switch(e){case"Worship":jQuery("#worshipListItem").attr("class","active"),jQuery("#messageListItem").removeAttr("class"),jQuery("#scriptureListItem").removeAttr("class"),jQuery("#worship").addClass("in active"),jQuery("#message").removeClass("in active"),jQuery("#scripture").removeClass("in active"),s(questionSet.toLowerCase(),questionOrScripturesActedOn);break;case"Message":jQuery("#worshipListItem").removeAttr("class"),jQuery("#messageListItem").attr("class","active"),jQuery("#scriptureListItem").removeAttr("class"),jQuery("#worship").removeClass("in active"),jQuery("#message").addClass("in active"),jQuery("#scripture").removeClass("in active"),s(questionSet.toLowerCase(),questionOrScripturesActedOn);break;case"Scripture":jQuery("#worshipListItem").removeAttr("class"),jQuery("#messageListItem").removeAttr("class"),jQuery("#scriptureListItem").attr("class","active"),jQuery("#worship").removeClass("in active"),jQuery("#message").removeClass("in active"),jQuery("#scripture").addClass("in active"),s(questionSet.toLowerCase(),questionOrScripturesActedOn)}}function i(e,t){switch(e){case"get":jQuery.ajax({type:"POST",url:"../config/"+e+"QuizStatus.php",data:t,success:function(e){o(e)},error:function(e,t,r){alert("Error: "+t+" from quizState GET")},dataType:"json"});break;case"store":var r=earnedPoints/parseInt(t.age);r=Math.round(1e3*r)/1e3,currentQuizStatus.eAForToday=(parseFloat(currentQuizStatus.eAForToday)+r).toString(),currentQuizStatus.eAForToday=(Math.round(1e3*currentQuizStatus.eAForToday)/1e3).toString();var s=parseFloat(t.totalAggregate)+r;t.totalAggregate=Math.round(1e3*s)/1e3;var a={date:c(),exercise:messageTitle,type:messageType,source:messageSource,score:t.tPoints,currentage:t.age,aggregate:currentQuizStatus.eAForToday,currentTotalAggregate:t.totalAggregate},u={status:t,scoresTableData:a};jQuery.ajax({type:"POST",url:"../config/"+e+"QuizStatus.php",data:u,success:function(e){console.log(e)},error:function(e,t,r){alert("Error: "+t+" from quizState Store")}})}}function o(e){if(currentQuizStatus.email=e.email,currentQuizStatus.age=e.age,""!==e.quizStatus){var t=jQuery.parseJSON(e.quizStatus);currentQuizStatus.cTab=t.cTab,currentQuizStatus.wQAnswered=t.wQAnswered,currentQuizStatus.mQAnswered=t.mQAnswered,currentQuizStatus.sTyped=t.sTyped,currentQuizStatus.tPoints=t.tPoints,currentQuizStatus.eAForToday=t.eAForToday,currentQuizStatus.totalAggregate=t.totalAggregate}else currentQuizStatus.totalAggregate=e.totalAggregate;n(currentQuizStatus.cTab)}function n(t){questionSet=t,p(t),e(t)}function c(){var e=new Date,t=e.getDate(),r=e.getMonth()+1,s=e.getFullYear();return 10>t&&(t="0"+t),10>r&&(r="0"+r),e=s+"-"+r+"-"+t}function p(e){switch(e){case"Worship":questionOrScripturesActedOn=parseInt(currentQuizStatus.wQAnswered);break;case"Message":questionOrScripturesActedOn=parseInt(currentQuizStatus.mQAnswered);break;case"Scripture":questionOrScripturesActedOn=parseInt(currentQuizStatus.sTyped)}}jQuery("#scriptureTextArea, #scriptureReferenceInput").on("cut copy paste",function(e){e.preventDefault()}),i("get",{}),jQuery("#worshipOptionsSelectList, #messageOptionsSelectList").change(function(){var e=jQuery(this);if("Select the most appropriate answer..."!=e.val())switch(e.attr("id")){case"worshipOptionsSelectList":jQuery("#worshipNextBtn").removeAttr("disabled");break;case"messageOptionsSelectList":jQuery("#messageNextBtn").removeAttr("disabled")}else switch(e.attr("id")){case"worshipOptionsSelectList":jQuery("#worshipNextBtn").attr("disabled","true");break;case"messageOptionsSelectList":jQuery("#messageNextBtn").attr("disabled","true")}}),jQuery("#worshipNextBtn, #messageNextBtn, #scriptureNextBtn").click(function(){var e=jQuery(this),t=questionSet.toLowerCase();switch(a(questionOrScripturesActedOn,e.attr("id")),questionOrScripturesActedOn++,e.attr("id")){case"worshipNextBtn":currentQuizStatus.wQAnswered=questionOrScripturesActedOn.toString();break;case"messageNextBtn":currentQuizStatus.mQAnswered=questionOrScripturesActedOn.toString();break;case"scriptureNextBtn":currentQuizStatus.sTyped=questionOrScripturesActedOn.toString()}jQuery(".totalQuestionNumber").text(allProcessedQuestions.length),jQuery(".totalQuestionsAnswered").text(questionOrScripturesActedOn),jQuery(".totalPointsGained").text(currentQuizStatus.tPoints),s(t,questionOrScripturesActedOn),i("store",currentQuizStatus),"scriptureNextBtn"!==e.attr("id")&&e.attr("disabled","true")}),jQuery('a[data-toggle="tab"]').on("shown.bs.tab",function(e){var t=jQuery(e.target).text();p(t),currentQuizStatus.cTab=t,n(t)})});